<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Multiple Testing &mdash; Duke NGS Course (Summer 2015) 1.0 documentation</title>
    
    <link rel="stylesheet" href="_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/bootstrap-3.2.0/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="_static/bootstrap-3.2.0/css/bootstrap-theme.min.css" type="text/css" />
    <link rel="stylesheet" href="_static/bootstrap-sphinx.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="_static/bootstrap-3.2.0/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="_static/bootstrap-sphinx.js"></script>
    <link rel="top" title="Duke NGS Course (Summer 2015) 1.0 documentation" href="index.html" />
    <link rel="next" title="Counting Models/Discrete Distributions" href="CountModels.html" />
    <link rel="prev" title="Unsupervised Learning and NGS" href="UnsupervisedLearningAndNGS.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head>
  <body role="document">

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="index.html">
          Duke NGS Course (Summer 2015)</a>
        <span class="navbar-text navbar-version pull-left"><b>1.0</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="VMsAtDuke.html">How to Claim and Access Your Virtual Machine</a></li>
<li class="toctree-l1"><a class="reference internal" href="BasicRinJupyterAndRstudio.html">Basic R in the Jupyter Notebook and RStudio</a></li>
<li class="toctree-l1"><a class="reference internal" href="IntroductionToR.html">Introduction to R</a></li>
<li class="toctree-l1"><a class="reference internal" href="PreparingDataForAnalysis.html">Preparing Data for Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="WorkingWithData.html">Working with Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="GroupingandAggregation.html">Grouping and Aggregation</a></li>
<li class="toctree-l1"><a class="reference internal" href="Hypothesistestingandpowercalcuations.html">Hypothesis Testing and Power Calculations</a></li>
<li class="toctree-l1"><a class="reference internal" href="Probabilitydistributionsandrandomnumbergeneration.html">Probability distributions and Random Number Genereation</a></li>
<li class="toctree-l1"><a class="reference internal" href="WritingcustomfunctionsinRSolutions.html">Writing Custom Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="FunctionalProgramming.html">Functional Programming</a></li>
<li class="toctree-l1"><a class="reference internal" href="RFormulasAndStatisticalModeling.html">Linear Regression</a></li>
<li class="toctree-l1"><a class="reference internal" href="SupervisedLearning.html">Using R for supervised learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="SupervisedLearningWhatCouldGoWrong.html">Supervised Learning Continued - What Could Go Wrong?</a></li>
<li class="toctree-l1"><a class="reference internal" href="UnsupervisedLearning.html">Unsupervised Learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="UnsupervisedLearningAndNGS.html">Unsupervised Learning and NGS</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="">Multiple Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="CountModels.html">Counting Models/Discrete Distributions</a></li>
<li class="toctree-l1"><a class="reference internal" href="LogisticRegression.html">Generalized Linear Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="InstallPackages.html">Installing Graphics Packages</a></li>
<li class="toctree-l1"><a class="reference internal" href="BaseGraphics.html">Base Graphics</a></li>
<li class="toctree-l1"><a class="reference internal" href="MiscGraphics.html">Plotting Graphcs and Heatmpas</a></li>
<li class="toctree-l1"><a class="reference internal" href="BaseGraphicsGGPlotComparison.html">Introdcution to <code class="docutils literal"><span class="pre">ggplot2</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="GGPlot2Graphics.html">More <code class="docutils literal"><span class="pre">ggplot2</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="PracticeONE-Solutions.html">Practice ONE</a></li>
<li class="toctree-l1"><a class="reference internal" href="PracticeTWOSolutions.html">Practice TWO</a></li>
<li class="toctree-l1"><a class="reference internal" href="PracticeTHREESolutions.html">Practice THREE</a></li>
<li class="toctree-l1"><a class="reference internal" href="PracticeFOURSolutions.html">Practice FOUR</a></li>
<li class="toctree-l1"><a class="reference internal" href="DESeq2Notebook.html">Introduction to DESeq2</a></li>
<li class="toctree-l1"><a class="reference internal" href="DESeq2NotebookFromMatrix.html">Import count data using basic tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="Installation.html">Installing R, RStudio and IPython notebook with the R kernel</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">Multiple Testing</a><ul>
<li><a class="reference internal" href="#coin-toss-experiments">Coin Toss Experiments</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="UnsupervisedLearningAndNGS.html" title="Previous Chapter: Unsupervised Learning and NGS"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; Unsupervised ...</span>
    </a>
  </li>
  <li>
    <a href="CountModels.html" title="Next Chapter: Counting Models/Discrete Distributions"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">Counting Mode... &raquo;</span>
    </a>
  </li>
              
            
            
            
            
              <li class="hidden-sm">
<div id="sourcelink">
  <a href="_sources/MultipleTesting.txt"
     rel="nofollow">Source</a>
</div></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12">
      
  <div class="section" id="multiple-testing">
<h1>Multiple Testing<a class="headerlink" href="#multiple-testing" title="Permalink to this headline">¶</a></h1>
<p>We&#8217;ll begin by recreating the examples from this morning&#8217;s lecture:</p>
<div class="section" id="coin-toss-experiments">
<h2>Coin Toss Experiments<a class="headerlink" href="#coin-toss-experiments" title="Permalink to this headline">¶</a></h2>
<div class="code python highlight-python"><div class="highlight"><pre><span class="nb">set</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">231</span><span class="p">)</span>
<span class="n">x</span><span class="o">=</span><span class="n">sample</span><span class="p">(</span><span class="n">c</span><span class="p">(</span><span class="s">&quot;H&quot;</span><span class="p">,</span><span class="s">&quot;T&quot;</span><span class="p">),</span><span class="mi">10</span><span class="p">,</span><span class="n">replace</span><span class="o">=</span><span class="n">TRUE</span><span class="p">,</span><span class="n">prob</span><span class="o">=</span><span class="n">c</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">))</span> <span class="c"># Create a sample of size 10, with probability of &quot;H&quot; = 1/3</span>
                                                     <span class="c"># and probability of &quot;T&quot; = 2/3. Clearly, this is a biased coin.</span>
<span class="n">x</span>
</pre></div>
</div>
<ol class=list-inline>
    <li>'T'</li>
    <li>'T'</li>
    <li>'T'</li>
    <li>'T'</li>
    <li>'T'</li>
    <li>'T'</li>
    <li>'T'</li>
    <li>'H'</li>
    <li>'T'</li>
    <li>'T'</li>
</ol><div class="code python highlight-python"><div class="highlight"><pre><span class="c"># Test for biasedness</span>

<span class="n">binom</span><span class="o">.</span><span class="n">test</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">x</span><span class="o">==</span><span class="s">&#39;T&#39;</span><span class="p">),</span> <span class="n">n</span><span class="o">=</span><span class="n">length</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">p</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>    Exact binomial test

data:  sum(x == &quot;T&quot;) and length(x)
number of successes = 9, number of trials = 10, p-value = 0.02148
alternative hypothesis: true probability of success is not equal to 0.5
95 percent confidence interval:
 0.5549839 0.9974714
sample estimates:
probability of success
                   0.9
</pre></div>
</div>
<p>So, our test concludes the coin is biased. Now we toss two coins:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="nb">set</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">231</span><span class="p">)</span>
<span class="n">x1</span><span class="o">=</span><span class="n">sample</span><span class="p">(</span><span class="n">c</span><span class="p">(</span><span class="s">&quot;H&quot;</span><span class="p">,</span><span class="s">&quot;T&quot;</span><span class="p">),</span><span class="mi">10</span><span class="p">,</span><span class="n">replace</span><span class="o">=</span><span class="n">TRUE</span><span class="p">,</span><span class="n">prob</span><span class="o">=</span><span class="n">c</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">))</span>
<span class="n">x2</span><span class="o">=</span><span class="n">sample</span><span class="p">(</span><span class="n">c</span><span class="p">(</span><span class="s">&quot;H&quot;</span><span class="p">,</span><span class="s">&quot;T&quot;</span><span class="p">),</span><span class="mi">10</span><span class="p">,</span><span class="n">replace</span><span class="o">=</span><span class="n">TRUE</span><span class="p">,</span><span class="n">prob</span><span class="o">=</span><span class="n">c</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">))</span>
<span class="n">x1</span>
<span class="n">x2</span>
</pre></div>
</div>
<ol class=list-inline>
    <li>'T'</li>
    <li>'T'</li>
    <li>'T'</li>
    <li>'T'</li>
    <li>'T'</li>
    <li>'T'</li>
    <li>'T'</li>
    <li>'H'</li>
    <li>'T'</li>
    <li>'T'</li>
</ol><ol class=list-inline>
    <li>'T'</li>
    <li>'T'</li>
    <li>'T'</li>
    <li>'T'</li>
    <li>'T'</li>
    <li>'T'</li>
    <li>'H'</li>
    <li>'T'</li>
    <li>'T'</li>
    <li>'T'</li>
</ol><div class="code python highlight-python"><div class="highlight"><pre><span class="c"># Test for bias</span>
<span class="n">binom</span><span class="o">.</span><span class="n">test</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">x1</span><span class="o">==</span><span class="s">&#39;T&#39;</span><span class="p">),</span> <span class="n">n</span><span class="o">=</span><span class="n">length</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">p</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>    Exact binomial test

data:  sum(x1 == &quot;T&quot;) and length(x)
number of successes = 9, number of trials = 10, p-value = 0.02148
alternative hypothesis: true probability of success is not equal to 0.5
95 percent confidence interval:
 0.5549839 0.9974714
sample estimates:
probability of success
                   0.9
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">binom</span><span class="o">.</span><span class="n">test</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">x2</span><span class="o">==</span><span class="s">&#39;T&#39;</span><span class="p">),</span> <span class="n">n</span><span class="o">=</span><span class="n">length</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">p</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>    Exact binomial test

data:  sum(x2 == &quot;T&quot;) and length(x)
number of successes = 9, number of trials = 10, p-value = 0.02148
alternative hypothesis: true probability of success is not equal to 0.5
95 percent confidence interval:
 0.5549839 0.9974714
sample estimates:
probability of success
                   0.9
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre>?binom.test
</pre></div>
</div>
<table width="100%" summary="page for binom.test {stats}"><tr><td>binom.test {stats}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Exact Binomial Test</h2>

<h3>Description</h3>

<p>Performs an exact test of a simple null hypothesis about the
probability of success in a Bernoulli experiment.
</p>


<h3>Usage</h3>

<pre>
binom.test(x, n, p = 0.5,
           alternative = c("two.sided", "less", "greater"),
           conf.level = 0.95)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>x</code></td>
<td>
<p>number of successes, or a vector of length 2 giving the
numbers of successes and failures, respectively.</p>
</td></tr>
<tr valign="top"><td><code>n</code></td>
<td>
<p>number of trials; ignored if <code>x</code> has length 2.</p>
</td></tr>
<tr valign="top"><td><code>p</code></td>
<td>
<p>hypothesized probability of success.</p>
</td></tr>
<tr valign="top"><td><code>alternative</code></td>
<td>
<p>indicates the alternative hypothesis and must be
one of <code>"two.sided"</code>, <code>"greater"</code> or <code>"less"</code>.
You can specify just the initial letter.</p>
</td></tr>
<tr valign="top"><td><code>conf.level</code></td>
<td>
<p>confidence level for the returned confidence
interval.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Confidence intervals are obtained by a procedure first given in
Clopper and Pearson (1934).  This guarantees that the confidence level
is at least <code>conf.level</code>, but in general does not give the
shortest-length confidence intervals.
</p>


<h3>Value</h3>

<p>A list with class <code>"htest"</code> containing the following components:
</p>
<table summary="R valueblock">
<tr valign="top"><td><code>statistic</code></td>
<td>
<p>the number of successes.</p>
</td></tr>
<tr valign="top"><td><code>parameter</code></td>
<td>
<p>the number of trials.</p>
</td></tr>
<tr valign="top"><td><code>p.value</code></td>
<td>
<p>the p-value of the test.</p>
</td></tr>
<tr valign="top"><td><code>conf.int</code></td>
<td>
<p>a confidence interval for the probability of success.</p>
</td></tr>
<tr valign="top"><td><code>estimate</code></td>
<td>
<p>the estimated probability of success.</p>
</td></tr>
<tr valign="top"><td><code>null.value</code></td>
<td>
<p>the probability of success under the null,
<code>p</code>.</p>
</td></tr>
<tr valign="top"><td><code>alternative</code></td>
<td>
<p>a character string describing the alternative
hypothesis.</p>
</td></tr>
<tr valign="top"><td><code>method</code></td>
<td>
<p>the character string <code>"Exact binomial test"</code>.</p>
</td></tr>
<tr valign="top"><td><code>data.name</code></td>
<td>
<p>a character string giving the names of the data.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Clopper, C. J. &amp; Pearson, E. S. (1934).
The use of confidence or fiducial limits illustrated in the case of
the binomial.
<em>Biometrika</em>, <b>26</b>, 404&ndash;413.
</p>
<p>William J. Conover (1971),
<em>Practical nonparametric statistics</em>.
New York: John Wiley &amp; Sons.
Pages 97&ndash;104.
</p>
<p>Myles Hollander &amp; Douglas A. Wolfe (1973),
<em>Nonparametric Statistical Methods.</em>
New York: John Wiley &amp; Sons.
Pages 15&ndash;22.
</p>


<h3>See Also</h3>

<p><code>prop.test</code> for a general (approximate) test for equal or
given proportions.
</p>


<h3>Examples</h3>

<pre>
## Conover (1971), p. 97f.
## Under (the assumption of) simple Mendelian inheritance, a cross
##  between plants of two particular genotypes produces progeny 1/4 of
##  which are "dwarf" and 3/4 of which are "giant", respectively.
##  In an experiment to determine if this assumption is reasonable, a
##  cross results in progeny having 243 dwarf and 682 giant plants.
##  If "giant" is taken as success, the null hypothesis is that p =
##  3/4 and the alternative that p != 3/4.
binom.test(c(682, 243), p = 3/4)
binom.test(682, 682 + 243, p = 3/4)   # The same.
## =&gt; Data are in agreement with the null hypothesis.
</pre>

<hr /><div style="text-align: center;">[Package <em>stats</em> version 3.2.0 ]</div><div class="code python highlight-python"><div class="highlight"><pre># Suppose we toss 100 fair coins
count.reject=0
for (i in 1:100){
    x2=sample(c(&quot;H&quot;,&quot;T&quot;),10,replace=TRUE,prob=c(1/2,1/2))
    result=binom.test(sum(x2==&#39;T&#39;), n=length(x2), p = 0.5)
    print(result$p.value)
    if (result$p.value&lt;.05) {count.reject=count.reject+1}
    }
count.reject
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>[1] 0.34375
[1] 1
[1] 0.109375
[1] 1
[1] 1
[1] 0.109375
[1] 0.34375
[1] 0.34375
[1] 1
[1] 0.34375
[1] 0.7539063
[1] 0.7539063
[1] 0.34375
[1] 1
[1] 0.02148438
[1] 0.34375
[1] 0.34375
[1] 0.7539063
[1] 0.7539063
[1] 0.7539063
[1] 0.7539063
[1] 0.34375
[1] 0.7539063
[1] 0.7539063
[1] 1
[1] 0.34375
[1] 0.7539063
[1] 0.7539063
[1] 0.34375
[1] 0.7539063
[1] 1
[1] 0.34375
[1] 0.34375
[1] 1
[1] 1
[1] 0.7539063
[1] 0.7539063
[1] 0.109375
[1] 1
[1] 0.34375
[1] 0.7539063
[1] 1
[1] 0.34375
[1] 1
[1] 0.34375
[1] 0.34375
[1] 0.7539063
[1] 0.109375
[1] 1
[1] 0.109375
[1] 1
[1] 1
[1] 1
[1] 0.7539063
[1] 0.34375
[1] 1
[1] 0.109375
[1] 0.7539063
[1] 0.7539063
[1] 1
[1] 0.7539063
[1] 0.109375
[1] 0.34375
[1] 0.7539063
[1] 1
[1] 0.7539063
[1] 0.34375
[1] 0.109375
[1] 0.34375
[1] 0.34375
[1] 0.109375
[1] 0.7539063
[1] 0.7539063
[1] 0.7539063
[1] 0.7539063
[1] 1
[1] 1
[1] 0.34375
[1] 0.7539063
[1] 1
[1] 1
[1] 1
[1] 1
[1] 0.7539063
[1] 0.34375
[1] 0.02148438
[1] 0.109375
[1] 0.34375
[1] 0.7539063
[1] 0.34375
[1] 0.7539063
[1] 0.02148438
[1] 0.34375
[1] 0.34375
[1] 1
[1] 1
[1] 1
[1] 0.34375
[1] 0.7539063
[1] 0.7539063
</pre></div>
</div>
3<p>We can consider the number of tosses to be the &#8216;sample size&#8217; and the
number of hypotheses tested to be the number of coins tossed. Here, our
sample size is small compared to the number of hypotheses tested. In
genome data, the sample size is the number of patients and the number of
hypotheses tested is the number of genes (or SNPs) analyzed. If we set a
significance level of <span class="math">\(0.05\)</span>, we are saying that we expect to find
a false positive 5% of the time. So in our coin toss, we would expect to
find the coin to be fair 5 times out of 100.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="c"># What happens if we increase the number of tosses?</span>
</pre></div>
</div>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright Public Domain.<br/>
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.3.1.<br/>
    </p>
  </div>
</footer>
  </body>
</html>